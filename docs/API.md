---
id: api
title: API
---

## 方法

<AUTOGENERATED_TABLE_OF_CONTENTS>

---

## 快速开始

  - 编译文件

    ```
    const config = await Metro.loadConfig();

    await Metro.runBuild(config, {
      entry: 'index.js',
      out: 'bundle.js',
    });
    ```

  - 运行服务 & 通过文件系统监听改变

    ```
    const config = await Metro.loadConfig();

    await Metro.runServer(config, {
      port: 8080,
    });
    ```

## 文档

下面公开的所有函数都接受一个额外的 `config` 选项对象。该对象应该是你的 `metro.config.js` 文件公开的 [Metro 配置](CLI.md) - 你可以使用 `Metro.loadConfig` 获取它。

### `loadConfig(<options>)`

**基础配置：** `config`，`cwd`

加载 Metro 配置，从指定的选项中的 `config` 加载，或者从 `cwd` 遍历目录层级结构到根目录，直到找到配置文件（默认为 `metro.config.js`）。返回的配置已标准化，并会与 Metro 的默认值合并。

### `async runMetro(config)`

根据配置创建 Metro 服务器并将其返回。你可以将其作为现有服务器的中间件。

### `async runBuild(config, <options>)`

**必填选项：** `entry`，`out`

**基本配置:** `dev`，`optimize`，`platform`，`sourceMap`，`sourceMapUrl`

根据给定的 `platform` 构建 `entry`，并将其保存到 `out`。如果设置了 `sourceMap`，也会生成一个 source map。Source map 将内联展示，除非还定义了 `sourceMapUrl`。后一种情况下，将使用 `sourceMapUrl` 参数的名生成一个新文件。

### `async runServer(config, <options>)`

**基本选项：** `host`，`port`，`secure`，`secureKey`，`secureCert`，`hmrEnabled`

启动一个完整的 Metro HTTP 服务器。 它将监听指定的 `host:port`，然后可以查询以检索各个入口起点的包。如果存在 `secure` 系列选项，则服务器将通过 HTTPS 公开。如果设置了 `hmrEnabled`，服务器还将公开 websocket 服务器并将 HMR 客户端注入到生成的 bundle 中。

### `createConnectMiddleware(config, <options>)`

**基本选项：** `port`

创建一个可以响应 bundle 请求的 Connect 中间件，而不是创建完整服务器。然后可以将此中间件嵌入到自己服务器当中。`port` 参数是可选的，仅用于日志记录。
